<mat-card>
  <mat-toolbar color="warn" class="top-toolbar">
    <h1>
      <input [value]="beast.name" (change)="captureInput($event, 'name')" placeholder="Name">
      <input [value]="beast.plural" (change)="captureInput($event, 'plural')" placeholder="Pluralized Name">
    </h1>
    <div>
      <mat-form-field>
        <mat-label>Patreon Level</mat-label>
        <mat-select [value]="beast.patreon" (selectionChange)="captureSelect($event, 'patreon')">
          <mat-option value="0">
            Basic
          </mat-option>
          <mat-option value="3">
            Deluxe
          </mat-option>
          <mat-option value="20">
            Early Access
          </mat-option>
        </mat-select>
        <p>{{beast.patreon}}</p>
      </mat-form-field>
    </div>
  </mat-toolbar>

  <div class="content-shell">
    <div class="left">
      <div>
        <img *ngIf="beast.id" [src]="imageUrl" [alt]="beast.name" (error)="onImageError($event);">
      </div>

      <div class="margin-spacing flex-row-opposite" *ngIf="beast.id">
        <div>
          <label mat-raised-button color="accent" for="file-upload" class="custom-file-upload" matTooltip="10 MB limit">
            <i class="fa fa-cloud-upload"></i> Upload Image
          </label>
          <input id="file-upload" type="file" (change)="onMainImagePicked($event)" />
        </div>

        <div *ngIf="selectedRoleId">
          <label mat-raised-button color="accent" for="file-upload-role" class="custom-file-upload"
            matTooltip="10 MB limit">
            <i class="fa fa-cloud-upload"></i> Upload Role Image
          </label>
          <input id="file-upload-role" type="file" (change)="onRoleImagePicked($event)" />
        </div>
      </div>

      <br>
      <div class="margin-spacing" *ngIf="beast.id">
        <input class="table-input" placeholder="Get Image From Another Monster" [matAutocomplete]="imageauto"
          [formControl]="imageController" (blur)="captureImage($event)">
        <mat-autocomplete #imageauto="matAutocomplete">
          <mat-option *ngFor="let image of imagesFiltered | async" [value]="image.id">
            {{image.name}}
          </mat-option>
        </mat-autocomplete>
      </div>

      <br>
      <div class="thumbnailShell" *ngIf="beast.id">
        <mat-form-field>
          <mat-label>Thumbnail Position</mat-label>
          <mat-select [(value)]="beast.thumbnail" (selectionChange)="captureSelect($event, 'thumbnail')">
            <mat-option value="top left">
              top left
            </mat-option>
            <mat-option value="top center">
              top center
            </mat-option>
            <mat-option value="top right">
              top right
            </mat-option>
            <mat-option value="center left">
              center left
            </mat-option>
            <mat-option value="center center">
              center center
            </mat-option>
            <mat-option value="center right">
              center right
            </mat-option>
            <mat-option value="bottom left">
              bottom left
            </mat-option>
            <mat-option value="bottom center">
              bottom center
            </mat-option>
            <mat-option value="bottom right">
              bottom right
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div>
          <h3>Preview</h3>
          <img [ngStyle]="{'object-position': beast.thumbnail ? beast.thumbnail : 'top'}" class="preview"
            *ngIf="beast.id" [src]="previewUrl" [alt]="beast.name" (error)="onImageError($event);">
        </div>
      </div>

      <div class="download-token-shell" *ngIf="beast.id">
        <div>
          <label mat-raised-button color="accent" for="file-upload-token" class="custom-file-upload">
            <i class="fa fa-cloud-upload"></i> Upload Token
          </label>
          <input id="file-upload-token" type="file" (change)="onTokenImagePicked($event)" />
        </div>

        <div *ngIf="tokenExists || beast.imagesource" (click)="forceDownload(false)">
          <button mat-raised-button color="accent"><i class="fa-solid fa-download"></i> Download Token</button>
        </div>
      </div>
      <br>
      <div class="download-token-shell" *ngIf="beast.id && selectedRoleId">
        <div>
          <label mat-raised-button color="accent" for="file-upload-role-token" class="custom-file-upload">
            <i class="fa fa-cloud-upload"></i> Upload Role Token
          </label>
          <input id="file-upload-role-token" type="file" (change)="onTokenRoleImagePicked($event)" />
        </div>

        <div *ngIf="roleTokenExists" (click)="forceDownload(true)">
          <button mat-raised-button color="accent"><i class="fa-solid fa-download"></i> Download Role Token</button>
        </div>
      </div>
      <br>

      <div *ngIf="beast.id && beast.imagesource">
        <br>
        <p><strong>Artist: </strong>{{beast.artistInfo.artist}}</p>
      </div>

      <div *ngIf="beast.id && !beast.imagesource">
        <mat-form-field>
          <input placeholder="Default Artist" matInput [matAutocomplete]="artistauto" [formControl]="artistController">
          <mat-autocomplete #artistauto="matAutocomplete" [displayWith]="getDisplayTextArtist"
            (optionSelected)="setArtist($event)">
            <mat-option *ngFor="let artist of artistFiltered | async" [value]="artist">
              {{artist.artist}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <mat-form-field *ngIf="selectedRoleId">
          <input placeholder="Role Artist" matInput [matAutocomplete]="artistroleauto"
            [formControl]="artistRoleController">
          <mat-autocomplete #artistroleauto="matAutocomplete" [displayWith]="getDisplayTextArtist"
            (optionSelected)="setRoleArtist($event)">
            <mat-option *ngFor="let artist of artistRoleFiltered | async" [value]="artist">
              {{artist.artist}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </div>

      <mat-accordion *ngIf="beast.id && !beast.imagesource">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              <h3><i class="fa-solid fa-plus icon-medium"></i> New Artist</h3>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <div class="new-roll-shell">
            <mat-form-field>
              <input #artistName placeholder="Artist Name" matInput (change)="captureNewArtist('artist', $event)">
            </mat-form-field>

            <mat-form-field>
              <input #artistLink placeholder="Link" matInput (change)="captureNewArtist('link', $event)">
            </mat-form-field>

            <mat-form-field>
              <textarea #artistTooltip placeholder="Tooltop" matInput
                (change)="captureNewArtist('tooltip', $event)"></textarea>
            </mat-form-field>
            <button mat-raised-button (click)="addNewArtist()" color="accent"><i
                class="fa-solid fa-plus icon-medium"></i> Artist</button>
          </div>

        </mat-expansion-panel>
      </mat-accordion>

      <div class="margin-spacing" *ngIf="!beast.id">
        <h3>You need to save this monster before uploading an image</h3>
      </div>
    </div>

    <div class="right">
      <h2>Introduction</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.intro" (onContentChanged)="captureHTML($event, 'intro')"></quill-editor>
        <p class="character-counter">{{beast.intro ? beast.intro.length : 0}} / 500 <i
            class="fas fa-info-circle icon-small" matTooltip="This also counts the HTML tags which are invisible."></i>
        </p>
      </div>

      <h2>Appearance</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.ecology" (onContentChanged)="captureHTML($event, 'ecology')"></quill-editor>
        <p class="character-counter">{{beast.ecology ? beast.ecology.length : 0}} / 1,000 <i
            class="fas fa-info-circle icon-small" matTooltip="This also counts the HTML tags which are invisible."></i>
        </p>
      </div>

      <div class="edit-table-shell">
        <div *ngIf="beast.tables">
          <app-edit-table *ngFor="let table of beast.tables.appearance; let i = index" [table]="table" [index]="i"
            [removeTable]="removeTable('appearance')"></app-edit-table>
        </div>
        <button mat-raised-button (click)="addNewTable('appearance')" color="accent"><i
            class="fa-solid fa-plus icon-medium"></i><i class="fa-solid fa-table"></i></button>
      </div>

      <h2>Common Folklore</h2>
      <div class="divider"></div>
      <div>
        <div *ngFor="let lore of beast.folklore; let i = index" class="belief-display">
          <mat-form-field>
            <input matInput placeholder="Belief" [value]="lore.belief" max="500"
              (input)="captureFolklore('belief', i, $event)">
            <mat-hint align="end">{{lore.belief.length}}/500</mat-hint>
          </mat-form-field>
          <mat-form-field>
            <input matInput placeholder="Truth" [value]="lore.truth" max="500"
              (input)="captureFolklore('truth', i, $event)">
            <mat-hint align="end">{{lore.truth.length}}/500</mat-hint>
          </mat-form-field>
          <i (click)="deleteFolkloreEntry(i)" class="fa-solid fa-trash"></i>
        </div>
        <div class="belief-display">
          <mat-form-field>
            <input matInput placeholder="Belief" [value]="folklore.belief" max="500"
              (input)="captureNewFolklore('belief', $event)" (blur)="addNewFolklore()">
            <mat-hint align="end">{{folklore.belief ? folklore.belief.length : 0}}/500</mat-hint>
          </mat-form-field>
          <mat-form-field>
            <input matInput placeholder="Truth" [value]="folklore.truth" max="500"
              (input)="captureNewFolklore('truth', $event)" (blur)="addNewFolklore()">
            <mat-hint align="end">{{folklore.truth ? folklore.truth.length : 0}}/500</mat-hint>
          </mat-form-field>
        </div>
      </div>

      <h2>Habitat/Society</h2>
      <div class="divider"></div>
      <div>
        <quill-editor [(ngModel)]="beast.habitat" (onContentChanged)="captureHTML($event, 'habitat')"></quill-editor>
        <p class="character-counter">{{beast.habitat ? beast.habitat.length : 0}} / 10,000 <i
            class="fas fa-info-circle icon-small" matTooltip="This also counts the HTML tags which are invisible."></i>
        </p>
      </div>

      <div class="edit-table-shell">
        <div *ngIf="beast.tables">
          <app-edit-table *ngFor="let table of beast.tables.habitat; let i = index" [table]="table" [index]="i"
            [removeTable]="removeTable('habitat')"></app-edit-table>
        </div>
        <button mat-raised-button (click)="addNewTable('habitat')" color="accent"><i
            class="fa-solid fa-plus icon-medium"></i><i class="fa-solid fa-table"></i></button>
      </div>
    </div>
  </div>

  <div class="combat-role-shell">
    <div class="conflict-shell unset-width flex-opposite" *ngIf="beast.roles.length > 0">
      <mat-form-field class="select-width">
        <mat-label>Select Role</mat-label>
        <mat-select (selectionChange)="setRole($event)" [(value)]="selectedRoleId">
          <mat-select-trigger>{{beast.roleInfo[selectedRoleId].name}}</mat-select-trigger>
          <mat-option *ngFor="let role of beast.roles" [value]="role.id">
            <span class="role-select-span">
              {{role.name}}
              <p class="role-select-subtitle">{{(displayService.tooltipName(role.role, role.secondaryrole,
                role.socialrole, role.socialsecondary, role.skillrole))}}</p>
            </span>
          </mat-option>
        </mat-select>
      </mat-form-field>

      <p [innerHTML]="displayName(selectedRoleId)"></p>
      <section>
        <mat-checkbox [matTooltipDisabled]="!(selectedRoleId === beast.defaultrole)"
          [disabled]="selectedRoleId === beast.defaultrole" matTooltip="To set a new default, go to another Role"
          [checked]="selectedRoleId === beast.defaultrole" (change)="updateDefaultRole()">Default Role
        </mat-checkbox>
      </section>
    </div>

    <div *ngIf="selectedRoleId" class="flex-row-opposite">
      <mat-form-field>
        <input matInput placeholder="Change Role Name" [value]="beast.roleInfo[selectedRoleId].name"
          (input)="captureRoleName($event)" max="25">
        <mat-hint align="end">{{beast.roleInfo[selectedRoleId].name.length}}/25</mat-hint>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Name & Role Order</mat-label>
        <mat-select (selectionChange)="captureSelect($event, 'rolenameorder')"
          [value]="beast.rolenameorder ? beast.rolenameorder : '1'">
          <mat-option value="1" selected="selected">
            {{beast.name}} {{beast.roleInfo[selectedRoleId].name}}
          </mat-option>
          <mat-option value="2">
            {{beast.roleInfo[selectedRoleId].name}} {{beast.name}}
          </mat-option>
          <mat-option value="3">
            {{beast.roleInfo[selectedRoleId].name}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div>
        <div *ngIf="checkForDeleteRole">
          <button mat-raised-button (click)="deleteRole()" color="warn" matTooltip="Yes, Delete the Role"><i
              class="fa-solid fa-check"></i></button>
          <button mat-raised-button (click)="toggleCheckDeleteRole()" color="primary" matTooltip="Nevermind"><i
              class="fa-solid fa-x"></i></button>
        </div>
        <div *ngIf="!checkForDeleteRole">
          <button mat-raised-button (click)="toggleCheckDeleteRole()" color="warn">Delete Role</button>
        </div>
      </div>
    </div>

    <mat-accordion>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            <h3><i class="fa-solid fa-plus icon-medium"></i> New Role</h3>
          </mat-panel-title>
        </mat-expansion-panel-header>

        <div class="new-roll-shell">
          <p *ngIf="beast.roles.length === 0" class="warning">This role will be your default. All Skills,
            Characteristics, and Combat Info that you've filled out already will be transferred to this new role</p>

          <mat-form-field>
            <input #newRoleName placeholder="Role Name" matInput (input)="captureNewRole('name', $event)" max="25">
            <mat-hint align="end">{{newRole.name ? newRole.name.length : 0}}/25</mat-hint>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Combat Role Type</mat-label>
            <mat-select #newCombatRoleSelect (selectionChange)="captureNewRole('role', $event)"
              [disabled]="beast.roles.length === 0 && beast.role"
              [value]="beast.roles.length === 0 ? beast.role : null">
              <mat-option>
                None
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(combatRolesInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="secondary-role-margin">
            <mat-label>Combat Secondary Role Type</mat-label>
            <mat-select #newSecondaryRoleSelect (selectionChange)="captureNewRole('secondaryrole', $event)"
              [disabled]="beast.roles.length === 0 && beast.secondaryrole"
              [value]="beast.roles.length === 0 ? beast.secondaryrole : null">
              <mat-option>
                None
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(combatRolesSecondaryInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Confrontation Role Type</mat-label>
            <mat-select #newConfRoleSelect (selectionChange)="captureNewRole('socialrole', $event)"
              [disabled]="beast.roles.length === 0 && beast.socialrole"
              [value]="beast.roles.length === 0 ? beast.socialrole : null">
              <mat-option>
                None
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(socialRolesInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="secondary-role-margin">
            <mat-label>Confrontation Secondary Role Type</mat-label>
            <mat-select #newSecondaryConfRoleSelect (selectionChange)="captureNewRole('socialsecondary', $event)"
              [disabled]="beast.roles.length === 0 && beast.socialsecondary"
              [value]="beast.roles.length === 0 ? beast.socialsecondary : null">
              <mat-option>
                None
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(socialRolesSecondaryInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Skill Role Type</mat-label>
            <mat-select #newSkillRoleSelect (selectionChange)="captureNewRole('skillrole', $event)"
              [disabled]="beast.roles.length === 0 && beast.skillrole"
              [value]="beast.roles.length === 0 ? beast.skillrole : null">
              <mat-option>
                None
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(skillRolesInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <button mat-raised-button (click)="addNewRole()" color="accent"
            [disabled]="!(((newRole.role || newRole.socialrole || newRole.skillrole) || ((beast.role || beast.socialrole || beast.skillrole) && beast.roles.length === 0)) && newRole.name)">
            <i class="fa-solid fa-plus icon-medium"></i> Role</button>
        </div>

      </mat-expansion-panel>
    </mat-accordion>

    <br>
  </div>

  <h2>Tactics & Strategy</h2>
  <div class="divider"></div>
  <div>
    <quill-editor [(ngModel)]="beast.tactics" (onContentChanged)="captureHTML($event, 'tactics')"></quill-editor>
    <p class="character-counter">{{beast.tactics ? beast.tactics.length : 0}} / 3,000 <i
        class="fas fa-info-circle icon-small" matTooltip="This also counts the HTML tags which are invisible."></i></p>
  </div>

  <br>

  <mat-tab-group backgroundColor="warn">
    <mat-tab label="Confrontations">
      <div class="tab-wrapper">
        <div>
          <mat-form-field>
            <mat-label>Change Role Type</mat-label>
            <mat-select
              [(value)]="selectedRoleId && beast.roleInfo[selectedRoleId].socialrole ? beast.roleInfo[selectedRoleId].socialrole : selectedRoleId ? null : beast.socialrole"
              (selectionChange)="setSocialRoleType($event)">
              <mat-option>
                No Role
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(socialRolesInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Change Secondary Role Type</mat-label>
            <mat-select [(value)]="selectedRoleId && beast.roleInfo[selectedRoleId] && beast.roleInfo[selectedRoleId].socialsecondary ?
            beast.roleInfo[selectedRoleId].socialsecondary :
            selectedRoleId ? null : beast.socialsecondary" (selectionChange)="setSocialSecondaryRoleType($event)">
              <mat-option>
                None
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(socialRolesSecondaryInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div *ngIf="selectedSocialRole && selectedSocialRole.description">
          <p><strong>Description: </strong> {{selectedSocialRole.description}}</p>
        </div>

        <div *ngIf="selectedRoleId && beast.roleInfo[selectedRoleId].socialsecondary">
          <p class="top-margin"><strong>Secondary Description: </strong>
            {{socialRolesSecondaryInfo[beast.roleInfo[selectedRoleId].socialsecondary].description}}</p>
        </div>
        <div *ngIf="!selectedRoleId && beast.socialsecondary">
          <p class="top-margin"><strong>Secondary Description: </strong>
            {{socialRolesSecondaryInfo[beast.socialsecondary].description}}</p>
        </div>

        <div *ngIf="checkIfSoloOrElite('socialsecondary')" class="top-margin">
          <p>{{produceEliteOrSoloSocialAdditionalExplanation()}}</p>
        </div>

        <br>
        <mat-form-field>
          <mat-label>Confrontation Points</mat-label>
          <mat-select (selectionChange)="setPoints($event, 'socialpoints')"
            [value]="beast.roleInfo[selectedRoleId] ? beast.roleInfo[selectedRoleId].socialpoints : beast.socialpoints">
            <mat-option *ngFor="let rating of ratingsArray" [value]="rating.value">
              {{rating.label}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div class="vitals-shell" *ngIf="selectedRoleId ? beast.roleInfo[selectedRoleId].role : beast.role">
          <div class="long-field">
            <p><strong>Panic: </strong> {{mental.panic}}</p>
            <p><strong>Nerve: </strong> {{mental.stress}}</p>
            <p><strong>Caution: </strong> {{mental.caution}}</p>
          </div>

          <br>
          <app-mental-physical-display [statInfo]="mentalStats"
            [primaryRole]="selectedRoleId ? beast.roleInfo[selectedRoleId].role : beast.role" [checkStat]="checkStat"
            [stats]="selectedRoleId ? beast.roleInfo[selectedRoleId] : beast">
          </app-mental-physical-display>
        </div>

        <br>
        <div class="attack-and-defense-shell">
          <div class="attack-and-defense-inner-shell">
            <h2>Add. Confrontation Attack Info</h2>
            <div class="divider"></div>
            <br>
            <h3 *ngIf="selectedRoleId">Base Abilities</h3>
            <div>
              <quill-editor [(ngModel)]="beast.atk_conf" (onContentChanged)="captureHTML($event, 'atk_conf')">
              </quill-editor>
              <p class="character-counter">{{beast.atk_conf ? beast.atk_conf.length : 0}} / 3,000 <i
                  class="fas fa-info-circle icon-small"
                  matTooltip="This also counts the HTML tags which are invisible."></i>
              </p>
            </div>

            <div *ngIf="selectedRoleId">
              <br>
              <h3>Role-Specific Abilities</h3>
              <div>
                <quill-editor [(ngModel)]="beast.roleInfo[selectedRoleId].attack_conf"
                  (onContentChanged)="captureHTML($event, 'role conf attack')"></quill-editor>
                <p class="character-counter">{{beast.roleInfo[selectedRoleId].attack_conf ?
                  beast.roleInfo[selectedRoleId].attack_conf.length : 0}} / 3,000 <i
                    class="fas fa-info-circle icon-small"
                    matTooltip="This also counts the HTML tags which are invisible."></i></p>
              </div>
            </div>
          </div>
          <div class="attack-and-defense-inner-shell">
            <h2>Add. Confrontation Defense Info</h2>
            <div class="divider"></div>
            <br>
            <h3 *ngIf="selectedRoleId">Base Abilities</h3>
            <div>
              <quill-editor [(ngModel)]="beast.def_conf" (onContentChanged)="captureHTML($event, 'def_conf')">
              </quill-editor>
              <p class="character-counter">{{beast.def_conf ? beast.def_conf.length : 0}} / 3,000 <i
                  class="fas fa-info-circle icon-small"
                  matTooltip="This also counts the HTML tags which are invisible."></i>
              </p>
            </div>

            <div *ngIf="selectedRoleId">
              <br>
              <h3>Role-Specific Abilities</h3>
              <div>
                <quill-editor [(ngModel)]="beast.roleInfo[selectedRoleId].defense_conf"
                  (onContentChanged)="captureHTML($event, 'role conf defense')"></quill-editor>
                <p class="character-counter">{{beast.roleInfo[selectedRoleId].defense_conf ?
                  beast.roleInfo[selectedRoleId].defense_conf.length : 0}} / 3,000 <i
                    class="fas fa-info-circle icon-small"
                    matTooltip="This also counts the HTML tags which are invisible."></i></p>
              </div>
            </div>
          </div>
        </div>
        <br>
        <div>
          <h2>Archetype</h2>
          <div class="divider"></div>
          <mat-checkbox [checked]="selectedRoleId ? beast.roleInfo[selectedRoleId].hasarchetypes : beast.hasarchetypes"
            (change)="checkCheckBox($event.checked, 'hasarchetypes')"> This entry generates a character Archetype by
            default. </mat-checkbox>
          <br>
          <button mat-raised-button
            *ngIf="beast.roles.length > 0 && (selectedRoleId ? beast.roleInfo[selectedRoleId].hasarchetypes : beast.hasarchetypes)"
            (click)="toggleArchetypesForAllRoles('hasarchetypes')" color="accent">Toggle
            Archetypes for All Roles</button>
          <br>
          <mat-checkbox
            [checked]="selectedRoleId ? beast.roleInfo[selectedRoleId].hasmonsterarchetypes : beast.hasmonsterarchetypes"
            (change)="checkCheckBox($event.checked, 'hasmonsterarchetypes')"> This entry generates a monster Archetype
            by
            default. </mat-checkbox>
          <br>
          <button mat-raised-button
            *ngIf="beast.roles.length > 0 && (selectedRoleId ? beast.roleInfo[selectedRoleId].hasmonsterarchetypes : beast.hasmonsterarchetypes)"
            (click)="toggleArchetypesForAllRoles('hasmonsterarchetypes')" color="accent">Toggle Monster
            Archetypes for All Roles</button>
          <br>
        </div>
        <br>
        <div>
          <h2>Descriptions</h2>
          <div class="divider"></div>
          <app-characteristic-display [selectedRoleId]="selectedRoleId"
            [removeNewSecondaryItem]="removeNewSecondaryItem" [characteristicInfo]='beast.conflict.descriptions'
            [captureInput]="captureInput" [characteristicType]="'Description'"
            [checkCharacteristic]="checkCharacteristic"
            [socialpoints]="beast.roleInfo[selectedRoleId] ? beast.roleInfo[selectedRoleId].socialpoints : beast.socialpoints">
          </app-characteristic-display>

          <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'descriptions')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i>
            Description</button>
          <br />
          <br />

          <h2>Convictions</h2>
          <div class="divider"></div>
          <app-characteristic-display [selectedRoleId]="selectedRoleId"
            [removeNewSecondaryItem]="removeNewSecondaryItem" [characteristicInfo]='beast.conflict.convictions'
            [captureInput]="captureInput" [characteristicType]="'Conviction'"
            [checkCharacteristic]="checkCharacteristic"
            [socialpoints]="beast.roleInfo[selectedRoleId] ? beast.roleInfo[selectedRoleId].socialpoints : beast.socialpoints">
          </app-characteristic-display>

          <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'convictions')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i>
            Conviction</button>
          <br *ngIf="beast.conflict.convictions.length > 0" />
          <br />
          <mat-form-field class="characteristics-appearing" *ngIf="beast.conflict.convictions.length > 0">
            <input matInput placeholder="Max Convictions Appearing" [value]="beast.traitlimit"
              (change)="captureInput($event, 'traitlimit')" type="number">
          </mat-form-field>
          <br />

          <h2>Relationships</h2>
          <div class="divider"></div>
          <app-characteristic-display [selectedRoleId]="selectedRoleId"
            [removeNewSecondaryItem]="removeNewSecondaryItem" [characteristicInfo]='beast.conflict.devotions'
            [captureInput]="captureInput" [characteristicType]="'Devotion'" [checkCharacteristic]="checkCharacteristic"
            [socialpoints]="beast.roleInfo[selectedRoleId] ? beast.roleInfo[selectedRoleId].socialpoints : beast.socialpoints">
          </app-characteristic-display>

          <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'devotions')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i>
            Relationship</button>
          <br *ngIf="beast.conflict.devotions.length > 0" />
          <br />
          <mat-form-field class="characteristics-appearing" *ngIf="beast.conflict.devotions.length > 0">
            <input matInput placeholder="Max Relationships Appearing" [value]="beast.devotionlimit"
              (change)="captureInput($event, 'devotionlimit')" type="number">
          </mat-form-field>
          <br />


          <h2>Flaws</h2>
          <div class="divider"></div>

          <table class="checkbox-table">
            <thead>
              <tr>
                <th> </th>
                <th>Random</th>
                <th>All Roles</th>
                <th> </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let flaw of beast.conflict.flaws; let i = index"
                [ngClass]="{'noDisplay': !(!flaw.deleted && (selectedRoleId === flaw.socialroleid || flaw.allroles))}">
                <td *ngIf="flaw.trait !== 'Any'"><input class="table-input" placeholder="Flaw" matInput
                    [value]="flaw.trait" (change)="captureInput($event, 'conflict', i, 'flaws', 'trait')"></td>
                <td *ngIf="flaw.trait === 'Any'"> </td>
                <td matTooltip="Check this to make the Flaw random." matTooltipClass="my-tooltip">
                  <mat-checkbox (change)="checkRandomizeflaw(i, $event.checked)" [checked]="flaw.trait === 'Any'">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [checked]="flaw.allroles" (change)="checkAllRoles('flaws', i, $event.checked)">
                  </mat-checkbox>
                </td>
                <td>
                  <i mat-raised-button (click)="removeNewSecondaryItem('conflict', i, 'flaws')" color="warn"
                    class="fa-solid fa-trash"></i>
                </td>
              </tr>
            </tbody>
          </table>

          <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'flaws')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i>
            Flaw</button>
          <br *ngIf="beast.conflict.flaws.length > 0" />
          <br />

          <h2>Burdens & Injuries</h2>
          <div class="divider"></div>
          <table class="checkbox-table">
            <thead>
              <tr>
                <th colspan="3"> </th>
                <th colspan="4">Rank</th>
                <th></th>
              </tr>
              <tr>
                <td> </td>
                <td>Random</td>
                <td>All Roles</td>
                <td class="border-left">Random</td>
                <td>High</td>
                <td>Med</td>
                <td>Low</td>
                <td class="border-left"> </td>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let burden of beast.conflict.burdens; let i = index"
                [ngClass]="{'noDisplay': !(!burden.deleted && (selectedRoleId === burden.socialroleid || burden.allroles))}">

                <td *ngIf="burden.trait !== 'Any'">
                  <app-burden-display [burden]="burden" [allBurdens]="allBurdens" [captureInput]="captureInput" [i]="i"
                    [_filterGroup]="_filterGroup"></app-burden-display>
                </td>
                <td *ngIf="burden.trait === 'Any'"> </td>

                <td matTooltip="Check this to make the Burden random." matTooltipClass="my-tooltip">
                  <mat-checkbox [checked]="burden.trait === 'Any'" (change)="checkRandomizeBurden(i, $event.checked)">
                  </mat-checkbox>
                </td>

                <td>
                  <mat-checkbox [checked]="burden.allroles" (change)="checkAllRoles('burdens', i, $event.checked)">
                  </mat-checkbox>
                </td>

                <td>
                  <mat-checkbox [checked]="burden.value == 1" (change)="checkBurden(burden, 1, $event)"></mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [checked]="burden.value == 2" (change)="checkBurden(burden, 2, $event)"></mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [checked]="burden.value == 3" (change)="checkBurden(burden, 3, $event)"></mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [checked]="burden.value == 4" (change)="checkBurden(burden, 4, $event)"></mat-checkbox>
                </td>

                <td>
                  <i mat-raised-button (click)="removeNewSecondaryItem('conflict', i, 'burdens')" color="warn"
                    class="fa-solid fa-trash"></i>
                </td>
              </tr>
            </tbody>
          </table>

          <button mat-raised-button (click)="addNewSecondaryItem('conflict', 'burdens')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i> Burden</button>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Skills">
      <ng-template matTabContent>
        <div class="tab-wrapper">
          <mat-form-field>
            <mat-label>Change Role Type</mat-label>
            <mat-select
              [(value)]="selectedRoleId && beast.roleInfo[selectedRoleId].skillrole ? beast.roleInfo[selectedRoleId].skillrole : selectedRoleId ? null : beast.skillrole"
              (selectionChange)="setSkillRoleType($event)">
              <mat-option>
                No Role
              </mat-option>
              <mat-option *ngFor="let role of objectKeys(skillRolesInfo)" [value]="role">
                {{role}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <div *ngIf="selectedSkillRole && selectedSkillRole.description">
            <p><strong>Description: </strong> {{selectedSkillRole.description}}</p>
          </div>

          <br>
          <mat-form-field>
            <mat-label>Skill Points</mat-label>
            <mat-select (selectionChange)="setPoints($event, 'skillpoints')"
              [value]="beast.roleInfo[selectedRoleId] ? beast.roleInfo[selectedRoleId].skillpoints : beast.skillpoints">
              <mat-option *ngFor="let rating of ratingsArray" [value]="rating.value">
                {{rating.label}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <div class="vitals-shell" *ngIf="selectedRoleId ? beast.roleInfo[selectedRoleId].role : beast.role">
            <div class="long-field">
              <p><strong>Panic: </strong> {{mental.panic}}</p>
              <p><strong>Nerve: </strong> {{mental.stress}}</p>
              <p><strong>Caution: </strong> {{mental.caution}}</p>
            </div>

            <br>
            <app-mental-physical-display [statInfo]="mentalStats"
              [primaryRole]="selectedRoleId ? beast.roleInfo[selectedRoleId].role : beast.role" [checkStat]="checkStat"
              [stats]="selectedRoleId ? beast.roleInfo[selectedRoleId] : beast">
            </app-mental-physical-display>
          </div>

          <br>
          <div class="attack-and-defense-shell">
            <div class="attack-and-defense-inner-shell">
              <h2>Add. Skills Attack Info</h2>
              <div class="divider"></div>
              <br>
              <h3 *ngIf="selectedRoleId">Base Abilities</h3>
              <div>
                <quill-editor [(ngModel)]="beast.atk_skill" (onContentChanged)="captureHTML($event, 'atk_skill')">
                </quill-editor>
                <p class="character-counter">{{beast.atk_skill ? beast.atk_skill.length : 0}} / 3,000 <i
                    class="fas fa-info-circle icon-small"
                    matTooltip="This also counts the HTML tags which are invisible."></i>
                </p>
              </div>

              <div *ngIf="selectedRoleId">
                <br>
                <h3>Role-Specific Abilities</h3>
                <div>
                  <quill-editor [(ngModel)]="beast.roleInfo[selectedRoleId].attack_skill"
                    (onContentChanged)="captureHTML($event, 'role skill attack')"></quill-editor>
                  <p class="character-counter">{{beast.roleInfo[selectedRoleId].attack_skill ?
                    beast.roleInfo[selectedRoleId].attack_skill.length : 0}} / 3,000 <i
                      class="fas fa-info-circle icon-small"
                      matTooltip="This also counts the HTML tags which are invisible."></i></p>
                </div>
              </div>
            </div>
            <div class="attack-and-defense-inner-shell">
              <h2>Add. Skills Defense Info</h2>
              <div class="divider"></div>
              <br>
              <h3 *ngIf="selectedRoleId">Base Abilities</h3>
              <div>
                <quill-editor [(ngModel)]="beast.def_skill" (onContentChanged)="captureHTML($event, 'def_skill')">
                </quill-editor>
                <p class="character-counter">{{beast.def_skill ? beast.def_skill.length : 0}} / 3,000 <i
                    class="fas fa-info-circle icon-small"
                    matTooltip="This also counts the HTML tags which are invisible."></i>
                </p>
              </div>

              <div *ngIf="selectedRoleId">
                <br>
                <h3>Role-Specific Abilities</h3>
                <div>
                  <quill-editor [(ngModel)]="beast.roleInfo[selectedRoleId].defense_skill"
                    (onContentChanged)="captureHTML($event, 'role skill defense')"></quill-editor>
                  <p class="character-counter">{{beast.roleInfo[selectedRoleId].defense_skill ?
                    beast.roleInfo[selectedRoleId].defense_skill.length : 0}} / 3,000 <i
                      class="fas fa-info-circle icon-small"
                      matTooltip="This also counts the HTML tags which are invisible."></i></p>
                </div>
              </div>
            </div>
          </div>
          <br>
          <h2>Skills</h2>
          <div class="divider"></div>

          <div class="characteristic-edit-shell">
            <div *ngFor="let skill of beast.skills; let i = index"
              [ngClass]="{'noDisplay': !(!skill.deleted && (selectedRoleId === skill.skillroleid || skill.allroles))}">

            </div>
          </div>

          <table class="checkbox-table">
            <thead>
              <tr>
                <th colspan="4">
                </th>
                <th colspan="4">
                  Scaling
                </th>
                <th colspan="4">
                  No Scaling
                </th>
                <th>
                </th>
              </tr>
              <tr>
                <td> </td>
                <td>All Roles</td>
                <td>Rank</td>
                <td class="border-left">Adj</td>
                <td class="border-left">Major Strength</td>
                <td>Minor Strength</td>
                <td>Minor Weakness</td>
                <td>Major Weakness</td>
                <td class="border-left">5</td>
                <td>3</td>
                <td>1</td>
                <td>0</td>
                <td> </td>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let skill of beast.skills; let i = index"
                [ngClass]="{'noDisplay': !(!skill.deleted && (selectedRoleId === skill.skillroleid || skill.allroles))}">
                <td>
                  <app-skill-display [skillInfo]="skill" [captureInput]="captureInput" [i]="i"
                    [selectedSkillRole]="selectedSkillRole">
                  </app-skill-display>
                </td>
                <td matTooltip="Skill is added to all Roles." matTooltipClass="my-tooltip">
                  <mat-checkbox [checked]="skill.allroles" (change)="checkAllRoles('skills', i, $event.checked)">
                  </mat-checkbox>
                </td>
                <td>{{getSkillRank(skill.strength, skill.adjustment)}}</td>
                <td><input class="table-input text-center" [value]="skill.adjustment"
                    (change)="captureInput($event, 'skills', i, 'adjustment')" type="number"></td>
                <td class="border-left">
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'majSt' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('majSt', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'majSt' : skill.strength === 'majSt'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'majSt'">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'minSt' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('minSt', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'minSt' : skill.strength === 'minSt'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'minSt'">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'minWk' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('minWk', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'minWk' : skill.strength === 'minWk'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'minWk'">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'majWk' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('majWk', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'majWk' : skill.strength === 'majWk'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'majWk'">
                  </mat-checkbox>
                </td>
                <td class="border-left">
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'noneStr' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('noneStr', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'noneStr' : skill.strength === 'noneStr'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'noneStr'">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [ngClass]="skill && !skill[skill] ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('none', i, $event)"
                    [checked]="!skill.strength ? skill && (skill[skill] === 'none' || !skill[skill]) : skill.strength === 'none'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill]">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'one' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('one', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'one' : skill.strength === 'one'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'one'">
                  </mat-checkbox>
                </td>
                <td>
                  <mat-checkbox [ngClass]="skill && skill[skill] === 'noneWk' ? 'checkmark-role-background' : ''"
                    (change)="checkSkill('noneWk', i, $event)"
                    [checked]="!skill.strength ? skill && skill[skill] === 'noneWk' : skill.strength === 'noneWk'"
                    matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                    [matTooltipDisabled]="skill && skill[skill] !== 'noneWk'">
                  </mat-checkbox>
                </td>
                <td>
                  <i mat-raised-button (click)="removeNewSecondaryItem('skills', i)" color="warn"
                    class="fa-solid fa-trash"></i>
                </td>
              </tr>
            </tbody>
          </table>
          <button mat-raised-button (click)="addNewSecondaryItem('skills')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i> Skill</button>

          <br>
          <br>
          <br>

          <h2>Single Obstacles</h2>
          <div class="divider"></div>
          <mat-chip-list>
            <div *ngFor="let obstacle of beast.obstacles; let i = index">
              <mat-chip (click)="removeChip('obstacles', i)" color="warn" selected>
                {{obstacle.name}}</mat-chip>
            </div>
          </mat-chip-list>

          <mat-form-field>
            <input matInput placeholder="Name of Obstacle" [matAutocomplete]="obstacleauto"
              [formControl]="obstacleController">
            <mat-autocomplete #obstacleauto="matAutocomplete" (optionSelected)="captureObstacle($event)"
              [displayWith]="getDisplayVariant">
              <mat-option *ngFor="let obstacle of obstaclesFiltered | async" [value]="obstacle">
                {{obstacle.name}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <br>
          <br>
          <h2>Skill Challenges</h2>
          <div class="divider"></div>
          <mat-chip-list>
            <div *ngFor="let challenge of beast.challenges; let i = index">
              <mat-chip (click)="removeChip('challenges', i)" color="warn" selected>
                {{challenge.name}}</mat-chip>
            </div>
          </mat-chip-list>

          <mat-form-field>
            <input matInput placeholder="Name of Challenge" [matAutocomplete]="challengeauto"
              [formControl]="challengeController">
            <mat-autocomplete #challengeauto="matAutocomplete" (optionSelected)="captureChallenge($event)"
              [displayWith]="getDisplayVariant">
              <mat-option *ngFor="let challenge of challengesFiltered | async" [value]="challenge">
                {{challenge.name}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>

      </ng-template>
    </mat-tab>
    <mat-tab label="Combat">
      <ng-template matTabContent>
        <div class="tab-wrapper">
          <div>
            <mat-form-field>
              <mat-label>Change Role Type</mat-label>
              <mat-select
                [(value)]="selectedRoleId && beast.roleInfo[selectedRoleId].role ? beast.roleInfo[selectedRoleId].role : selectedRoleId ? null : beast.role"
                (selectionChange)="setRoleType($event)">
                <mat-option>
                  No Role
                </mat-option>
                <mat-option *ngFor="let role of objectKeys(combatRolesInfo)" [value]="role">
                  {{role}}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <mat-form-field>
              <mat-label>Change Secondary Role Type</mat-label>
              <mat-select [(value)]="selectedRoleId && beast.roleInfo[selectedRoleId] && beast.roleInfo[selectedRoleId].secondaryrole ?
              beast.roleInfo[selectedRoleId].secondaryrole : selectedRoleId ? null : beast.secondaryrole"
                (selectionChange)="setSecondaryRoleType($event)">
                <mat-option>
                  None
                </mat-option>
                <mat-option *ngFor="let role of objectKeys(combatRolesSecondaryInfo)" [value]="role">
                  {{role}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div *ngIf="selectedRole && selectedRole.description">
            <p><strong>Description: </strong> {{selectedRole.description}}</p>
          </div>

          <div *ngIf="selectedRoleId && beast.roleInfo[selectedRoleId].secondaryrole">
            <p class="top-margin"><strong>Secondary Description: </strong>
              {{combatRolesSecondaryInfo[beast.roleInfo[selectedRoleId].secondaryrole].description}}</p>
          </div>
          <div *ngIf="!selectedRoleId && beast.secondaryrole">
            <p class="top-margin"><strong>Secondary Description: </strong>
              {{combatRolesSecondaryInfo[beast.secondaryrole].description}}</p>
          </div>
          <div *ngIf="checkIfSoloOrElite('secondaryrole')" class="top-margin">
            <p>{{produceEliteOrSoloAdditionalExplanation()}}</p>
            <ul>
              <li>
                Movement
                <ul>
                  <li>Move away from enemies</li>
                  <li>Move enemies</li>
                  <li>Pin enemies</li>
                </ul>
              </li>
              <li>
                Attack
                <ul>
                  <li>Damage multiple enemies</li>
                  <li>Multiple attacks</li>
                  <li>Faster attacks</li>
                </ul>
              </li>
              <li>
                Defense
                <ul>
                  <li>Parry multiple enemies (not Defense)</li>
                </ul>
              </li>
              <li>
                Allies
                <ul>
                  <li>Apply any of the above to multiple allies</li>
                </ul>
              </li>
            </ul>
            <p *ngIf="addExtraIfSolo('secondaryrole')">And have an ability that triggers when they become Wounded / Shaken</p>
          </div>

          <div
            *ngIf="!(selectedRoleId && beast.roleInfo[selectedRoleId].role ? beast.roleInfo[selectedRoleId].role : selectedRoleId ? null : beast.role)">
            <h3>You need to select a Primary Role to edit anything else</h3>
          </div>
          <div
            *ngIf="selectedRoleId && beast.roleInfo[selectedRoleId].role ? beast.roleInfo[selectedRoleId].role : selectedRoleId ? null : beast.role">
            <br>
            <mat-form-field>
              <mat-label>Combat Points</mat-label>
              <mat-select (selectionChange)="setPoints($event, 'combatpoints')"
                [value]="beast.roleInfo[selectedRoleId] ? beast.roleInfo[selectedRoleId].combatpoints : beast.combatpoints">
                <mat-option *ngFor="let rating of ratingsArray" [value]="rating.value">
                  {{rating.label}}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <div class="vitals-shell">
              <div class="long-field">
                <p><strong>Fatigue: </strong> {{physical.fatigue}}</p>
                <span class="vitality-span-tag">
                  <p><strong>Vitality: </strong> {{physical.largeweapons}}</p>
                  <img *ngIf="selectedRoleId ? beast.roleInfo[selectedRoleId].isincorporeal : beast.isincorporeal"
                    class="vitality-marker"
                    matTooltip="This creature takes no damage from any source except those specifically called out"
                    src="./assets/incorporeal.png" alt="Incorporeal">
                  <img
                    *ngIf="selectedRoleId ? beast.roleInfo[selectedRoleId].weaponbreakagevitality : beast.weaponbreakagevitality"
                    class="vitality-marker"
                    matTooltip="This creature only takes damage when it would take Wear on a 1-to-1 basis"
                    src="./assets/weapon-breakage.png" alt="Weapon Breakage Vitality">
                  <p>{{physical.diceString}}</p>
                </span>
                <p><strong>Caution: </strong> {{mental.caution}}</p>
              </div>
              <br>
              <app-mental-physical-display [statInfo]="physicalStats"
                [primaryRole]="selectedRoleId ? beast.roleInfo[selectedRoleId].role : beast.role"
                [checkStat]="checkStat" [stats]="selectedRoleId ? beast.roleInfo[selectedRoleId] : beast">
              </app-mental-physical-display>
              <br>
              <div class="vitality-info-shell">
                <div>
                  <mat-checkbox
                    [checked]="selectedRoleId ? beast.roleInfo[selectedRoleId].singledievitality : beast.singledievitality"
                    (change)="checkCheckBox($event.checked, 'singledievitality')">Single Die Vitality
                  </mat-checkbox>
                </div>
                <div>
                  <mat-checkbox
                    [checked]="selectedRoleId ? beast.roleInfo[selectedRoleId].isincorporeal : beast.isincorporeal"
                    (change)="checkCheckBox($event.checked, 'isincorporeal')">Incorporeal? <i
                      class="fas fa-info-circle icon-small blue"
                      matTooltip="This creature takes no damage from any source except those specifically called out"
                      matTooltipClass="my-tooltip"></i>
                  </mat-checkbox>
                </div>
                <div>
                  <mat-checkbox
                    [checked]="selectedRoleId ? beast.roleInfo[selectedRoleId].weaponbreakagevitality : beast.weaponbreakagevitality"
                    (change)="checkCheckBox($event.checked, 'weaponbreakagevitality')">Weapon Breakage Vitality? <i
                      class="fas fa-info-circle icon-small blue"
                      matTooltip="This creature only takes damage when it would take Wear on a 1-to-1 basis"
                      matTooltipClass="my-tooltip"></i>
                  </mat-checkbox>
                </div>
                <div>
                  <mat-checkbox
                    [checked]="selectedRoleId ? beast.roleInfo[selectedRoleId].noknockback : beast.noknockback"
                    (change)="checkCheckBox($event.checked, 'noknockback')">Immune to Knockbacks?
                  </mat-checkbox>
                  <br *ngIf="!(selectedRoleId ? beast.roleInfo[selectedRoleId].noknockback : beast.noknockback)">
                  <br *ngIf="!(selectedRoleId ? beast.roleInfo[selectedRoleId].noknockback : beast.noknockback)">
                  <mat-form-field
                    *ngIf="!(selectedRoleId ? beast.roleInfo[selectedRoleId].noknockback : beast.noknockback)">
                    <input placeholder="Knock Back Threshold" matInput
                      [value]="beast.roleInfo[selectedRoleId] && beast.roleInfo[selectedRoleId].knockback ? beast.roleInfo[selectedRoleId].knockback : beast.roleInfo[selectedRoleId] && beast.roleInfo[selectedRoleId].size ? sizeDictionary[beast.roleInfo[selectedRoleId].size] : beast.knockback ? beast.knockback : sizeDictionary[beast.size] ? sizeDictionary[beast.size] : null"
                      (change)="captureBasicInput($event, 'knockback')" type="number">
                  </mat-form-field>
                </div>
                <div>
                  <mat-checkbox [checked]="beast.notrauma" (change)="checkTrauma($event.checked)">Immune to Trauma?
                  </mat-checkbox>
                  <div *ngIf="!beast.notrauma">
                    <br>
                    <p>Needs to Roll Under: {{selectedRoleId ? beast.roleInfo[selectedRoleId].rollundertrauma :
                      beast.rollundertrauma}}</p>
                    <mat-slider (input)="captureSliderInput($event)" min="1" max="20" step="1"
                      [value]="selectedRoleId ? beast.roleInfo[selectedRoleId].rollundertrauma : beast.rollundertrauma">
                      <input matSliderThumb>
                    </mat-slider>
                  </div>
                </div>
              </div>

              <div class="locational-shell">
                <div *ngFor="let location of beast.locationalvitality; let i = index" class="locational-id-shell"
                  [ngClass]="{'noDisplay': !(!location.deleted && (selectedRoleId === location.roleid || location.allroles))}">
                  <mat-form-field>
                    <input placeholder="Location" matInput [value]="location.location"
                      (change)="captureInput($event, 'locationalvitality', i, 'location')">
                    <mat-hint align="end">{{location.location.length}}/250</mat-hint>
                  </mat-form-field>
                  <mat-form-field>
                    <input placeholder="Vitality" matInput [value]="location.vitality"
                      (change)="captureInput($event, 'locationalvitality', i, 'vitality')">
                    <mat-hint align="end">{{location.vitality.length}}/250</mat-hint>
                  </mat-form-field>
                  <p>(Ave: {{calculatorService.calculateAverageOfDice(location.vitality)}})</p>
                  <section>
                    <mat-checkbox [checked]="location.allroles"
                      (change)="checkAllRoles('locationalvitality', i, $event.checked)">
                      Add to all Roles</mat-checkbox>
                  </section>
                  <button mat-raised-button (click)="removeNewSecondaryItem('locationalvitality', i)" color="warn"><i
                      class="fa-solid fa-trash"></i></button>
                </div>
              </div>
              <button mat-raised-button (click)="addNewSecondaryItem('locationalvitality')" color="accent"><i
                  class="fa-solid fa-plus icon-medium"></i> Locational
                Vitality</button>
            </div>

            <br>
            <div class="attack-and-defense-shell">
              <div class="attack-and-defense-inner-shell">
                <h2>Add. Combat Attack Info</h2>
                <div class="divider"></div>
                <br>
                <h3 *ngIf="selectedRoleId">Base Abilities</h3>
                <div>
                  <quill-editor [(ngModel)]="beast.sp_atk" (onContentChanged)="captureHTML($event, 'sp_atk')">
                  </quill-editor>
                  <p class="character-counter">{{beast.sp_atk ? beast.sp_atk.length : 0}} / 3,000 <i
                      class="fas fa-info-circle icon-small"
                      matTooltip="This also counts the HTML tags which are invisible."></i>
                  </p>
                </div>

                <div *ngIf="selectedRoleId">
                  <br>
                  <h3>Role-Specific Abilities</h3>
                  <div>
                    <quill-editor [(ngModel)]="beast.roleInfo[selectedRoleId].attack"
                      (onContentChanged)="captureHTML($event, 'role attack')"></quill-editor>
                    <p class="character-counter">{{beast.roleInfo[selectedRoleId].attack ?
                      beast.roleInfo[selectedRoleId].attack.length : 0}} / 3,000 <i
                        class="fas fa-info-circle icon-small"
                        matTooltip="This also counts the HTML tags which are invisible."></i></p>
                  </div>
                </div>

                <div class="edit-table-shell">
                  <div *ngIf="beast.tables">
                    <app-edit-table *ngFor="let table of beast.tables.attack; let i = index" [table]="table" [index]="i"
                      [removeTable]="removeTable('attack')"></app-edit-table>
                  </div>
                  <button mat-raised-button (click)="addNewTable('attack')" color="accent"><i
                      class="fa-solid fa-plus icon-medium"></i><i class="fa-solid fa-table"></i></button>
                </div>
              </div>
              <div class="attack-and-defense-inner-shell">
                <h2>Add. Combat Defense Info</h2>
                <div class="divider"></div>
                <br>
                <h3 *ngIf="selectedRoleId">Base Abilities</h3>
                <div>
                  <quill-editor [(ngModel)]="beast.sp_def" (onContentChanged)="captureHTML($event, 'sp_def')">
                  </quill-editor>
                  <p class="character-counter">{{beast.sp_def ? beast.sp_def.length : 0}} / 3,000 <i
                      class="fas fa-info-circle icon-small"
                      matTooltip="This also counts the HTML tags which are invisible."></i>
                  </p>
                </div>

                <div *ngIf="selectedRoleId">
                  <br>
                  <h3>Role-Specific Abilities</h3>
                  <div>
                    <quill-editor [(ngModel)]="beast.roleInfo[selectedRoleId].defense"
                      (onContentChanged)="captureHTML($event, 'role defense')"></quill-editor>
                    <p class="character-counter">{{beast.roleInfo[selectedRoleId].defense ?
                      beast.roleInfo[selectedRoleId].defense.length : 0}} / 3,000 <i
                        class="fas fa-info-circle icon-small"
                        matTooltip="This also counts the HTML tags which are invisible."></i></p>
                  </div>
                </div>

                <div class="edit-table-shell">
                  <div *ngIf="beast.tables">
                    <app-edit-table *ngFor="let table of beast.tables.defense; let i = index" [table]="table"
                      [index]="i" [removeTable]="removeTable('defense')"></app-edit-table>
                  </div>
                  <button mat-raised-button (click)="addNewTable('defense')" color="accent"><i
                      class="fa-solid fa-plus icon-medium"></i><i class="fa-solid fa-table"></i></button>
                </div>
              </div>
            </div>

            <div class="combat-shell unset-width">
              <div *ngFor="let square of beast.combatStatArray; let i = index">
                <div *ngIf="!square.deleted && selectedRoleId === square.roleid"
                  class="combat-info-shell-outer unset-width">
                  <app-combat-info [primaryRole]="selectedRoleId ? beast.roleInfo[selectedRoleId].role : beast.role"
                    [combatStats]="square"
                    [points]="selectedRoleId ? beast.roleInfo[selectedRoleId].combatpoints : beast.combatpoints"
                    [physical]="selectedRoleId ? beast.roleInfo[selectedRoleId] : beast"
                    [physicalCallback]="setVitalityAndStress"
                    [size]="selectedRoleId && beast.roleInfo[selectedRoleId].size ? beast.roleInfo[selectedRoleId].size : beast.size ? beast.size : 'Medium'"
                    [secondaryRole]="selectedRoleId ? beast.roleInfo[selectedRoleId].secondaryrole : beast.secondaryrole"
                    [removeCallback]="removeCombatStatFromArray" [index]="i"></app-combat-info>
                </div>
              </div>
              <button mat-raised-button (click)="addNewSecondaryItem('combatStatArray')" color="accent"><i
                  class="fa-solid fa-plus icon-medium"></i> Combat Square</button>
            </div>

            <br>

            <h2>Movement</h2>
            <div class="vitals-shell movement-shell">
              <div *ngFor="let movementType of beast.movement; let i = index"
                [ngClass]="{'noDisplay': !(!movementType.deleted && (selectedRoleId === movementType.roleid || movementType.allroles))}">
                <div *ngIf="i > 0" class="divider white"></div>
                <h3>
                  <mat-form-field>
                    <input placeholder="Movement Type" matInput [value]="movementType.type"
                      (change)="captureInput($event, 'movement', i, 'type')">
                    <mat-hint align="end">{{movementType.type.length}}/250</mat-hint>
                  </mat-form-field>
                </h3>
                <table>
                  <thead>
                    <tr>
                      <th>
                      </th>
                      <th colspan="4">
                        Scaling
                      </th>
                      <th colspan="4">
                        No Scaling
                      </th>
                    </tr>
                    <tr>
                      <td> </td>
                      <td>Major Strength</td>
                      <td>Minor Strength</td>
                      <td>Minor Weakness</td>
                      <td>Major Weakness</td>
                      <td class="border-left">Major Strength</td>
                      <td>Baseline</td>
                      <td>Major Weakness</td>
                      <td>Nothing</td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let stat of movementStats">
                      <td class="vitality-span-tag">{{stat.label}} <p>{{!movementType.movementSpeeds[stat.speed] ? '' :
                          movementType.movementSpeeds[stat.speed] + ' ft / sec'}} </p>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'majSt' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'majSt', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'majSt' : movementType[stat.stat] === 'majSt'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'majSt'">
                        </mat-checkbox>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'minSt' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'minSt', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'minSt' : movementType[stat.stat] === 'minSt'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'minSt'">
                        </mat-checkbox>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'minWk' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'minWk', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'minWk' : movementType[stat.stat] === 'minWk'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'minWk'">
                        </mat-checkbox>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'majWk' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'majWk', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'majWk' : movementType[stat.stat] === 'majWk'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'majWk'">
                        </mat-checkbox>
                      </td>
                      <td class="border-left">
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'noneStr' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'noneStr', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'noneStr' : movementType[stat.stat] === 'noneStr'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'noneStr'">
                        </mat-checkbox>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && !selectedRole.meleeCombatStats.movement ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'none', $event, i)"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement"
                          [checked]="(!movementType[stat.stat] && selectedRole.meleeCombatStats && !selectedRole.meleeCombatStats.movement) || movementType[stat.stat] === 'none'">
                        </mat-checkbox>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'noneWk' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'noneWk', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'noneWk' : movementType[stat.stat] === 'noneWk'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'noneWk'">
                        </mat-checkbox>
                      </td>
                      <td>
                        <mat-checkbox
                          [ngClass]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'x' ? 'checkmark-role-background' : ''"
                          (change)="checkMovementStat(stat.stat, 'x', $event, i)"
                          [checked]="!movementType[stat.stat] ? selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement === 'x' : movementType[stat.stat] === 'x'"
                          matTooltip="This is the preferred scale for their Role" matTooltipClass="my-tooltip"
                          [matTooltipDisabled]="selectedRole.meleeCombatStats && selectedRole.meleeCombatStats.movement !== 'x'">
                        </mat-checkbox>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <br>
                <mat-form-field>
                  <input placeholder="Adjustment" matInput [value]="movementType.adjustment"
                    (change)="getAdjustment('movement', i, $event)" type="number">
                </mat-form-field>

                <div class="flex-row-opposite">
                  <section>
                    <mat-checkbox [checked]="movementType.allroles"
                      (change)="checkAllRoles('movement', i, $event.checked)">
                      Add to all Roles</mat-checkbox>
                  </section>
                  <button mat-raised-button (click)="removeNewSecondaryItem('movement', i)" color="warn"><i
                      class="fa-solid fa-trash"></i></button>
                </div>
              </div>
            </div>
            <button mat-raised-button (click)="addNewSecondaryItem('movement')" color="accent"><i
                class="fa-solid fa-plus icon-medium"></i> Movement</button>
          </div>
        </div>
      </ng-template>
    </mat-tab>
    <mat-tab label="Encounters">
      <div class="tab-wrapper" id="random-encounter-tab">
        <h2>Scenarios</h2>
        <div class="divider"></div>
        <div>
          <div *ngFor="let scenario of beast.scenarios; let i = index" class="scenario-display">
            <mat-form-field>
              <input matInput placeholder="Scenario" [value]="scenario.scenario" max="500"
                (input)="captureScenario(i, $event)">
              <mat-hint align="end">{{scenario.scenario.length}}/500</mat-hint>
            </mat-form-field>
            <i (click)="deleteScenarioEntry(i)" class="fa-solid fa-trash"></i>
          </div>
          <div class="scenario-display">
            <mat-form-field>
              <input matInput placeholder="Scenario" [value]="scenario" max="500" (input)="captureNewScenario($event)"
                (blur)="addNewScenario($event)">
              <mat-hint align="end">{{scenario ? scenario.length : 0}}/500</mat-hint>
            </mat-form-field>
          </div>
        </div>

        <h2>Random Encounters</h2>
        <div class="divider"></div>
        <div *ngIf="encounter" class="random-encounters">
          <div class="random-container">
            <table class="first-column-left">
              <thead>
                <th colspan="3">Temperament</th>
              </thead>
              <tr>
                <th>Value</th>
                <th>Weight</th>
                <th></th>
              </tr>
              <tr *ngFor="let temperament of encounter.temperament.temperament; let i = index"
                [ngClass]="{'noDisplay': temperament.deleted}">
                <td matTooltip="{{temperament.tooltip}}" matTooltipPosition="right">{{temperament.temperament}}</td>
                <td><input class="table-input" placeholder="Weight" value="{{temperament.weight}}"
                    (change)="changeEncounterItemSubtype($event, 'temperament', 'weight', i)" type="number"></td>
                <td><i (click)="removeEncounterItem(i, 'temperament', 'temperament')" class="fa-solid fa-trash"></i>
                </td>
              </tr>
              <tr>
                <td>
                  <input class="table-input-clearable" placeholder="Temperament" [matAutocomplete]="tempauto"
                    [formControl]="temperamentController">
                  <mat-autocomplete #tempauto="matAutocomplete" [displayWith]="getDisplayTextTemp"
                    (optionSelected)="captureEncounterAutocomplete($event, 'temperament', 'temperament')">
                    <mat-option *ngFor="let temperament of tempFiltered | async" [value]="temperament"
                      matTooltip="{{temperament.tooltip}}" matTooltipPosition="right">
                      {{temperament.temperament}}
                    </mat-option>
                  </mat-autocomplete>
                </td>
                <td><input class="table-input-clearable" placeholder="Weight"
                    (change)="captureEncounterInput($event, 'temperament', 'weight')" type="number"></td>

                <td><i *ngIf="temperament.temperament && temperament.weight"
                    (click)="addEncounterItem('temperament', 'temperament')"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                  <i *ngIf="!temperament.temperament && !temperament.weight"
                    [ngClass]="{'disabled': !temperament.temperament || !temperament.weight}"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                </td>
              </tr>
            </table>
          </div>

          <div class="random-container">
            <table class="first-column-left">
              <thead>
                <th colspan="4">Number Appearing</th>
              </thead>
              <tr>
                <th>Numbers</th>
                <th>Miles from Lair</th>
                <th>Weight</th>
                <th></th>
              </tr>
              <tr *ngFor="let row of encounter.numbers; let i = index" [ngClass]="{'noDisplay': row.deleted}">
                <td><input class="table-input" value="{{row.numbers}}"
                    (change)="changeEncounterItem($event, 'numbers', 'numbers', i)"></td>
                <td><input class="table-input" value="{{row.miles}}"
                    (change)="changeEncounterItem($event, 'numbers', 'miles', i)"></td>
                <td><input class="table-input" value="{{row.weight}}"
                    (change)="changeEncounterItem($event, 'numbers', 'weight', i)" type="number"></td>
                <td><i (click)="removeSingleEncounter(i, 'numbers')" class="fa-solid fa-trash"></i></td>
              </tr>
              <tr>
                <td><input class="table-input-clearable" placeholder="Number in dice"
                    (change)="captureEncounterInput($event, 'numbers', 'numbers')"></td>
                <td><input class="table-input-clearable" placeholder="Miles in dice"
                    (change)="captureEncounterInput($event, 'numbers', 'miles')"></td>
                <td><input class="table-input-clearable" placeholder="Weight"
                    (change)="captureEncounterInput($event, 'numbers', 'weight')" type="number"></td>
                <td><i *ngIf="numbers.numbers && numbers.weight && numbers.miles"
                    (click)="addSingleEncounterItem('numbers')" class="fa-sharp fa-solid fa-square-plus"></i>
                  <i *ngIf="!numbers.numbers && !numbers.weight && !numbers.miles"
                    [ngClass]="{'disabled': !numbers.numbers || !numbers.weight || !numbers.miles}"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                </td>
              </tr>
            </table>

          </div>

          <div class="random-container">
            <table class="first-column-left">
              <thead>
                <th colspan="4">Groups</th>
              </thead>
              <tr>
                <th>Group</th>
                <th>Role</th>
                <th>Weight</th>
                <th></th>
              </tr>
              <tbody class="table-subsection" *ngFor="let group of encounter.groups; let i = index"
                [ngClass]="{'noDisplay': group.deleted}">
                <tr>
                  <td colspan="2"><input placeholder="Group Label" value="{{group.label}}" class="table-input"
                      (change)="changeEncounterItem($event, 'groups', 'label', i)"></td>
                  <td><input placeholder="Group Weight" value="{{group.weight}}" class="table-input"
                      (change)="changeEncounterItem($event, 'groups', 'weight', i)" type="number"></td>
                  <td><i (click)="removeSingleEncounter(i, 'groups')" class="fa-solid fa-trash"></i></td>
                </tr>
                <tr *ngFor="let row of group.weights; let rowi = index" [ngClass]="{'noDisplay': row.deleted}">
                  <td> </td>
                  <td><input placeholder="Role" value="{{row.role}}" class="table-input"
                      (change)="changeEncounterItemInArray($event, 'groups', 'weights', i, rowi, 'role')"></td>
                  <td><input placeholder="Weight" value="{{row.weight}}" class="table-input"
                      (change)="changeEncounterItemInArray($event, 'groups', 'weights', i, rowi, 'weight')"
                      type="number"></td>
                  <td><i (click)="removeEncounterItemFromInnerArray('groups', i, 'weights', rowi)"
                      class="fa-solid fa-trash"></i></td>
                </tr>
                <tr>
                  <td> </td>
                  <td><input placeholder="Role" class="table-input-clearable"
                      (change)="captureEncounterInputAtIndex($event, 'weights', 'role', i)"></td>
                  <td><input placeholder="Role Weight" class="table-input-clearable"
                      (change)="captureEncounterInputAtIndex($event, 'weights', 'weight', i)" type="number"></td>
                  <td><i *ngIf="weights[i] && weights[i].role && weights[i].weight"
                      (click)="addEncounterItemFromArray('groups','weights',  i)"
                      class="fa-sharp fa-solid fa-square-plus"></i>
                    <i *ngIf="!weights[i] || !weights[i].role && !weights[i].weight"
                      class="fa-sharp fa-solid fa-square-plus"></i>
                  </td>
                </tr>
              </tbody>
              <tbody class="table-subsection">
                <tr>
                  <td colspan="2"><input placeholder="Group Label" class="table-input-clearable"
                      (change)="captureEncounterInput($event, 'groups', 'label')"></td>
                  <td><input placeholder="Group Weight" class="table-input-clearable"
                      (change)="captureEncounterInput($event, 'groups', 'weight')" type="number"></td>
                  <td><i *ngIf="groups.label && groups.weight" [ngClass]="{'disabled': !groups.label || !groups.weight}"
                      (click)="addSingleEncounterItem('groups')"
                      class="subheader-icon fa-sharp fa-solid fa-square-plus"></i>
                    <i *ngIf="!groups.label && !groups.weight" [ngClass]="{'disabled': !groups.label || !groups.weight}"
                      class="subheader-icon fa-sharp fa-solid fa-square-plus"></i>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="random-container">
            <table class="first-column-left">
              <thead>
                <th colspan="2">Verb</th>
              </thead>
              <tr *ngFor="let verb of encounter.verb.verb; let i = index" [ngClass]="{'noDisplay': verb.deleted}">
                <td>{{verb.verb}}</td>
                <td><i (click)="removeEncounterItem(i, 'verb', 'verb')" class="fa-solid fa-trash"></i></td>
              </tr>

              <tr>
                <td>
                  <input class="table-input-clearable" placeholder="Verb" [matAutocomplete]="verbauto"
                    [formControl]="verbController" (blur)="addOption($event, 'verb')">
                  <mat-autocomplete #verbauto="matAutocomplete" #verbAutocomplete [displayWith]="getDisplayTextVerb"
                    id="verb" (optionSelected)="captureEncounterAutocomplete($event, 'verb', 'verb')"
                    (opened)="jumpToOption('verb')">
                    <mat-option *ngFor="let verb of verbFiltered | async" [value]="verb">
                      {{verb.verb}}
                    </mat-option>
                  </mat-autocomplete>
                </td>

                <td><i *ngIf="verb.verb" (click)="addEncounterItem('verb', 'verb')"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                  <i *ngIf="!verb.verb" [ngClass]="{'disabled': !verb.verb}"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                </td>
              </tr>
            </table>
          </div>

          <div class="random-container">
            <table class="first-column-left">
              <thead>
                <th colspan="2">Noun</th>
              </thead>
              <tr *ngFor="let noun of encounter.noun.noun; let i = index" [ngClass]="{'noDisplay': noun.deleted}">
                <td>{{noun.noun}}</td>
                <td>
                  <i (click)="removeEncounterItem(i, 'noun', 'noun')" class="fa-solid fa-trash"></i>
                </td>
              </tr>
              <tr>
                <td>
                  <input class="table-input-clearable" placeholder="Noun" [matAutocomplete]="nounauto"
                    [formControl]="nounController" (blur)="addOption($event, 'noun')">
                  <mat-autocomplete #nounauto="matAutocomplete" #nounAutocomplete [displayWith]="getDisplayTextNoun"
                    (optionSelected)="captureEncounterAutocomplete($event, 'noun', 'noun')"
                    (opened)="jumpToOption('noun')">
                    <mat-option *ngFor="let noun of nounFiltered | async" [value]="noun">
                      {{noun.noun}}
                    </mat-option>
                  </mat-autocomplete>
                </td>

                <td><i *ngIf="noun.noun" (click)="addEncounterItem('noun', 'noun')"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                  <i *ngIf="!noun.noun" [ngClass]="{'disabled': !noun.noun}"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                </td>
              </tr>
            </table>
          </div>

          <div class="random-container">
            <table class="first-column-left">
              <thead>
                <th colspan="3">Signs <i class="fas fa-info-circle"
                    matTooltip="Signs are evidence of the monster's passing or evidence that the monster is near. They can be sights, sounds, leavings, victims, tracks, smells & vapors, environmental damage, and/or intentional markings."></i>
                </th>
              </thead>
              <tr>
                <th>Value</th>
                <th>Weight</th>
                <th></th>
              </tr>
              <tr *ngFor="let sign of encounter.signs.signs; let i = index" [ngClass]="{'noDisplay': sign.deleted}">
                <td>{{sign.sign}}</td>
                <td><input class="table-input" placeholder="Weight" value="{{sign.weight}}"
                    (change)="changeEncounterItemSubtype($event, 'signs', 'weight', i)" type="number"></td>
                <td><i (click)="removeEncounterItem(i, 'signs', 'signs')" class="fa-solid fa-trash"></i>
                </td>
              </tr>
              <tr>
                <td>
                  <input class="table-input-clearable" placeholder="Sign" [matAutocomplete]="signauto"
                    [formControl]="signsController" (blur)="addOption($event, 'signs')">
                  <mat-autocomplete #signauto="matAutocomplete" #signAutocomplete [displayWith]="getDisplayTextSign"
                    (optionSelected)="captureEncounterAutocomplete($event, 'signs', 'sign')"
                    (opened)="jumpToOption('sign')">
                    <mat-option matTooltip="{{sign.sign}}" *ngFor="let sign of signsFiltered | async" [value]="sign">
                      {{sign.sign}}
                    </mat-option>
                  </mat-autocomplete>
                </td>
                <td><input placeholder="Weight" class="table-input-clearable"
                    (change)="captureEncounterInput($event, 'signs', 'weight')" type="number">
                </td>
                <td><i *ngIf="signs.sign && signs.weight" (click)="addEncounterItem('signs', 'signs')"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                  <i *ngIf="!signs.sign && !signs.weight" [ngClass]="{'disabled': !signs.sign || !signs.weight}"
                    class="fa-sharp fa-solid fa-square-plus"></i>
                </td>
              </tr>
            </table>

            <!--             
            <h4 class="add-from-list">Add from List</h4>
            <div class="add-new-random">
              <mat-form-field>
                <mat-label>Select Sign</mat-label>
                <mat-select (selectionChange)="captureEncounter($event, 'signs')">
                  <mat-option *ngFor="let sign of encounter.signs.allSigns" [value]="sign">
                    {{sign.sign}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field>
                <input placeholder="Weight" matInput (change)="captureEncounterInput($event, 'signs', 'weight')">
              </mat-form-field>
            </div>
            <h4>Add New</h4>
            <div class="add-new-random">
              <mat-form-field>
                <input placeholder="Sign" matInput [value]="signs.sign"
                  (change)="captureEncounterInput($event, 'signs', 'sign')">
              </mat-form-field>
              <mat-form-field>
                <input placeholder="Weight" matInput [value]="signs.weight"
                  (change)="captureEncounterInputInt($event, 'signs', 'weight')">
              </mat-form-field>
            </div>
            <button mat-raised-button (click)="addEncounterItem('signs', 'signs')" color="accent"
              [disabled]="!signs.sign || !signs.weight"><i class="fa-solid fa-plus"></i></button> -->
          </div>
        </div>

      </div>
    </mat-tab>
    <mat-tab label="Loot">
      <ng-template matTabContent>
        <div class="tab-wrapper">
          <h2>Carried Loot</h2>
          <div class="divider"></div>
          <div class="characteristic-edit-shell">
            <div *ngFor="let lootitem of beast.loot; let i = index" [ngClass]="{'noDisplay': lootitem.deleted}"
              class="carried-loot-shell">
              <div class="conflict-shell edit-shell-box">
                <h3>
                  <mat-form-field>
                    <input placeholder="Loot" matInput [value]="lootitem.loot"
                      (input)="captureInput($event, 'loot', i, 'loot')">
                    <mat-hint align="end">{{lootitem.loot.length}}/500</mat-hint>
                  </mat-form-field>
                </h3>
                <mat-form-field>
                  <input placeholder="Value" matInput [value]="lootitem.price"
                    (change)="captureInput($event, 'loot', i, 'price')">
                  <mat-hint align="end">{{lootitem.price.length}}/500</mat-hint>
                </mat-form-field>
                <button mat-raised-button (click)="removeNewSecondaryItem('loot', i)" color="warn"><i
                    class="fa-solid fa-trash"></i></button>
              </div>
            </div>
          </div>
          <button mat-raised-button (click)="addNewSecondaryItem('loot')" color="accent"><i
              class="fa-solid fa-plus icon-medium"></i> Loot</button>
          <br />
          <br />
          <h3 class="loot-notes-subtitle">Loot Notes</h3>
          <div>
            <quill-editor [(ngModel)]="beast.lootnotes" (onContentChanged)="captureHTML($event, 'lootnotes')">
            </quill-editor>
            <p class="character-counter">{{beast.lootnotes ? beast.lootnotes.length : 0}} / 5,000 <i
                class="fas fa-info-circle icon-small"
                matTooltip="This also counts the HTML tags which are invisible."></i></p>
          </div>
          <br />

          <div class="lair-loot-shell">
            <div class="coins-and-enchanted-shell">
              <div class="lair-loot-category-shell">
                <h3>Coins</h3>
                <div class="loot-inner-shell">
                  <mat-form-field>
                    <mat-select [value]="beast.carriedloot.copper"
                      (selectionChange)="captureSelectForObject($event, 'copper', 'carriedloot')">
                      <mat-option>
                        Nothing
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

              <div class="lair-loot-category-shell">
                <h3>Enchanted Items</h3>
                <div class="loot-inner-shell">
                  <mat-form-field>
                    <mat-label>Chance</mat-label>
                    <mat-select [value]="beast.carriedloot.enchanted"
                      (selectionChange)="captureSelectForObject($event, 'enchanted', 'carriedloot')">
                      <mat-option>
                        No Chance
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>
            <div class="lair-loot-category-shell">
              <h3>Talismans, Potions, Scrolls, Alm Scripts</h3>
              <div>
                <br />
                <mat-form-field>
                  <mat-label>Talismans</mat-label>
                  <mat-select [value]="beast.carriedloot.talisman"
                    (selectionChange)="captureSelectForObject($event, 'talisman', 'carriedloot')">
                    <mat-option>
                      None
                    </mat-option>
                    <mat-option value="b">
                      Low
                    </mat-option>
                    <mat-option value="c">
                      Medium
                    </mat-option>
                    <mat-option value="d">
                      High
                    </mat-option>
                    <mat-option value="e">
                      Low, Nonscaling
                    </mat-option>
                    <mat-option value="f">
                      Medium, Nonscaling
                    </mat-option>
                    <mat-option value="g">
                      High, Nonscaling
                    </mat-option>
                  </mat-select>
                </mat-form-field>

                <div class="divider white"></div>

                <mat-form-field>
                  <mat-label>Potions</mat-label>
                  <mat-select [value]="beast.carriedloot.potion"
                    (selectionChange)="captureSelectForObject($event, 'potion', 'carriedloot')">
                    <mat-option>
                      None
                    </mat-option>
                    <mat-option value="b">
                      Low
                    </mat-option>
                    <mat-option value="c">
                      Medium
                    </mat-option>
                    <mat-option value="d">
                      High
                    </mat-option>
                    <mat-option value="e">
                      Low, Nonscaling
                    </mat-option>
                    <mat-option value="f">
                      Medium, Nonscaling
                    </mat-option>
                    <mat-option value="g">
                      High, Nonscaling
                    </mat-option>
                  </mat-select>
                </mat-form-field>

                <div class="divider white"></div>

                <table class="first-column-left">
                  <thead>
                    <th colspan="3">Scrolls</th>
                  </thead>
                  <tr>
                    <th>Number</th>
                    <th>Power (SP)</th>
                    <th></th>
                  </tr>
                  <tr *ngFor="let scroll of beast.carriedloot.scrolls; let i = index"
                    [ngClass]="{'noDisplay': scroll.deleted }">
                    <td>{{displayNameForLootValue(scroll.number)}}</td>
                    <td>{{displayNameForLootValue(scroll.power)}}</td>
                    <td><i (click)="removeScroll(i, 'carriedloot')" class="fa-solid fa-trash"></i>
                    </td>
                  </tr>
                </table>
                <div>
                  <mat-form-field>
                    <mat-label>Number of Scrolls</mat-label>
                    <mat-select (selectionChange)="captureScroll($event, 'number')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Scroll Power Range</mat-label>
                    <mat-select (selectionChange)="captureScroll($event, 'power')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <button mat-raised-button (click)="captureAddScroll('carriedloot')" color="accent"
                  [disabled]="!scroll.number || !scroll.power"><i class="fa-solid fa-plus"></i></button>

                <div class="divider white"></div>

                <table class="first-column-left">
                  <thead>
                    <th colspan="3">Alm Scripts</th>
                  </thead>
                  <tr>
                    <th>Number</th>
                    <th>Favor</th>
                    <th></th>
                  </tr>
                  <tr *ngFor="let alm of beast.carriedloot.alms; let i = index" [ngClass]="{'noDisplay': alm.deleted }">
                    <td>{{displayNameForLootValue(alm.number)}}</td>
                    <td>{{displayNameForLootValue(alm.favor)}}</td>
                    <td><i (click)="removeAlm(i, 'carriedloot')" class="fa-solid fa-trash"></i>
                    </td>
                  </tr>
                </table>
                <div>
                  <mat-form-field>
                    <mat-label>Number of Alm Scripts</mat-label>
                    <mat-select (selectionChange)="captureAlm($event, 'number')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Alm Script Favor Range</mat-label>
                    <mat-select (selectionChange)="captureAlm($event, 'favor')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <button mat-raised-button (click)="captureAddAlm('carriedloot')" color="accent"
                  [disabled]="!alm.number || !alm.favor"><i class="fa-solid fa-plus"></i></button>
              </div>
            </div>
          </div>

          <div class="item-shell">
            <h3>Equipment</h3>
            <app-equipment-display [items]="beast.carriedloot.items" [updateItem]="updateItem"
              [captureAddItem]="captureAddItem" [removeItem]="removeItem" [lootLocation]="'carriedloot'">
            </app-equipment-display>
          </div>

          <h2>Lair Loot</h2>
          <div class="divider"></div>
          <div class="lair-loot-shell">
            <div class="coins-and-enchanted-shell">
              <div class="lair-loot-category-shell">
                <h3>Coins</h3>
                <div class="loot-inner-shell">
                  <mat-form-field>
                    <mat-select [value]="beast.lairloot.copper"
                      (selectionChange)="captureSelectForObject($event, 'copper', 'lairloot')">
                      <mat-option>
                        Nothing
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
              <div class="lair-loot-category-shell">
                <h3>Enchanted Items</h3>
                <div class="loot-inner-shell">
                  <mat-form-field>
                    <mat-label>Chance</mat-label>
                    <mat-select [value]="beast.lairloot.enchanted"
                      (selectionChange)="captureSelectForObject($event, 'enchanted', 'lairloot')">
                      <mat-option>
                        No Chance
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
            </div>

            <div class="lair-loot-category-shell">
              <h3>Talismans, Potions, Scrolls, Alm Scripts</h3>
              <div>
                <br />
                <mat-form-field>
                  <mat-label>Talismans</mat-label>
                  <mat-select [value]="beast.lairloot.talisman"
                    (selectionChange)="captureSelectForObject($event, 'talisman', 'lairloot')">
                    <mat-option>
                      None
                    </mat-option>
                    <mat-option value="b">
                      Low
                    </mat-option>
                    <mat-option value="c">
                      Medium
                    </mat-option>
                    <mat-option value="d">
                      High
                    </mat-option>
                    <mat-option value="e">
                      Low, Nonscaling
                    </mat-option>
                    <mat-option value="f">
                      Medium, Nonscaling
                    </mat-option>
                    <mat-option value="g">
                      High, Nonscaling
                    </mat-option>
                  </mat-select>
                </mat-form-field>

                <div class="divider white"></div>

                <mat-form-field>
                  <mat-label>Potions</mat-label>
                  <mat-select [value]="beast.lairloot.potion"
                    (selectionChange)="captureSelectForObject($event, 'potion', 'lairloot')">
                    <mat-option>
                      None
                    </mat-option>
                    <mat-option value="b">
                      Low
                    </mat-option>
                    <mat-option value="c">
                      Medium
                    </mat-option>
                    <mat-option value="d">
                      High
                    </mat-option>
                    <mat-option value="e">
                      Low, Nonscaling
                    </mat-option>
                    <mat-option value="f">
                      Medium, Nonscaling
                    </mat-option>
                    <mat-option value="g">
                      High, Nonscaling
                    </mat-option>
                  </mat-select>
                </mat-form-field>

                <div class="divider white"></div>

                <table class="first-column-left">
                  <thead>
                    <th colspan="3">Scrolls</th>
                  </thead>
                  <tr>
                    <th>Number</th>
                    <th>Power (SP)</th>
                    <th></th>
                  </tr>
                  <tr *ngFor="let scroll of beast.lairloot.scrolls; let i = index"
                    [ngClass]="{'noDisplay': scroll.deleted }">
                    <td>{{displayNameForLootValue(scroll.number)}}</td>
                    <td>{{displayNameForLootValue(scroll.power)}}</td>
                    <td><i (click)="removeScroll(i, 'lairloot')" class="fa-solid fa-trash"></i>
                    </td>
                  </tr>
                </table>
                <div>
                  <mat-form-field>
                    <mat-label>Number of Scrolls</mat-label>
                    <mat-select (selectionChange)="captureScroll($event, 'number')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Scroll Power Range</mat-label>
                    <mat-select (selectionChange)="captureScroll($event, 'power')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <button mat-raised-button (click)="captureAddScroll('lairloot')" color="accent"
                  [disabled]="!scroll.number || !scroll.power"><i class="fa-solid fa-plus"></i></button>

                <div class="divider white"></div>

                <table class="first-column-left">
                  <thead>
                    <th colspan="3">Alm Scripts</th>
                  </thead>
                  <tr>
                    <th>Number</th>
                    <th>Favor</th>
                    <th></th>
                  </tr>
                  <tr *ngFor="let alm of beast.lairloot.alms; let i = index" [ngClass]="{'noDisplay': alm.deleted }">
                    <td>{{displayNameForLootValue(alm.number)}}</td>
                    <td>{{displayNameForLootValue(alm.favor)}}</td>
                    <td><i (click)="removeAlm(i, 'lairloot')" class="fa-solid fa-trash"></i>
                    </td>
                  </tr>
                </table>
                <div>
                  <mat-form-field>
                    <mat-label>Number of Alm Scripts</mat-label>
                    <mat-select (selectionChange)="captureAlm($event, 'number')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <mat-form-field>
                    <mat-label>Alm Script Favor Range</mat-label>
                    <mat-select (selectionChange)="captureAlm($event, 'favor')">
                      <mat-option>
                        None
                      </mat-option>
                      <mat-option value="b">
                        Low
                      </mat-option>
                      <mat-option value="c">
                        Medium
                      </mat-option>
                      <mat-option value="d">
                        High
                      </mat-option>
                      <mat-option value="e">
                        Low, Nonscaling
                      </mat-option>
                      <mat-option value="f">
                        Medium, Nonscaling
                      </mat-option>
                      <mat-option value="g">
                        High, Nonscaling
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <button mat-raised-button (click)="captureAddAlm('lairloot')" color="accent"
                  [disabled]="!alm.number || !alm.favor"><i class="fa-solid fa-plus"></i></button>
              </div>
            </div>

            <div class="item-shell">
              <h3>Equipment</h3>
              <app-equipment-display [items]="beast.lairloot.items" [updateItem]="updateItem"
                [captureAddItem]="captureAddItem" [removeItem]="removeItem" [lootLocation]="'lairloot'">
              </app-equipment-display>
            </div>

          </div>
        </div>
      </ng-template>
    </mat-tab>
    <mat-tab label="The Weird">
      <ng-template matTabContent>

        <h2>Weird Pleroma</h2>
        <div class="divider"></div>
        <div *ngFor="let reagent of beast.reagents; let i = index">
          <app-pleroma-display *ngIf="!reagent.deleted" [i]="i" [allSpells]="allSpells" [reagent]="reagent"
            [captureInput]="captureInput" [captureEncounterSecondary]="captureEncounterSecondary"
            [removeNewSecondaryItem]="removeNewSecondaryItem"></app-pleroma-display>
        </div>

        <button mat-raised-button (click)="addNewSecondaryItem('reagents')" color="accent"><i
            class="fa-solid fa-plus"></i></button>

        <!-- <h2>Special Harvest</h2> -->

        <br>
        <br>
        <br>

        <h2>Weirdshaping</h2>
        <div class="divider"></div>
        <div class="tab-wrapper">
          <app-weird-shaping-edit [casting]="beast.casting" [spells]="beast.spells"
            [checkWeirdshapeType]="checkWeirdshapeType" [deleteSpell]="deleteSpell" [addNewSpell]="addNewSpell"
            [captureSpellHTML]="captureSpellHTML" [captureSpellInput]="captureSpellInput"
            [changeDefaultType]="changeDefaultType" [captureSpellSelect]="captureSpellSelect"
            [captureSpellDie]="captureSpellDie" [addToAllRoles]="addToAllRoles" [selectedRoleId]="selectedRoleId">
          </app-weird-shaping-edit>
        </div>
      </ng-template>
    </mat-tab>
    <mat-tab label="General Information">
      <ng-template matTabContent>
        <div class="tab-wrapper">
          <h2>Creature Type</h2>
          <div class="divider"></div>
          <div class="chip-shell box-padding">
            <mat-chip-list>
              <div *ngFor="let type of beast.types; let i = index">
                <mat-chip *ngIf="!type.deleted" (click)="removeNewSecondaryItem('types', i)" color="warn" selected>
                  {{type.typeid | typeConverter}}</mat-chip>
              </div>
            </mat-chip-list>
            <mat-form-field>
              <mat-label>Select New Type</mat-label>
              <mat-select (selectionChange)="captureChip($event, 'types')">
                <mat-option value="1">
                  Demon
                </mat-option>
                <mat-option value="2">
                  Undead, Corporeal
                </mat-option>
                <mat-option value="3">
                  Undead, Incorporeal
                </mat-option>
                <mat-option value="4">
                  Elemental
                </mat-option>
                <mat-option value="5">
                  Bestial
                </mat-option>
                <mat-option value="6">
                  Weird Creature
                </mat-option>
                <mat-option value="7">
                  Humanoid
                </mat-option>
                <mat-option value="8">
                  Intelligent Evil
                </mat-option>
                <mat-option value="9">
                  Goblin
                </mat-option>
                <mat-option value="10">
                  Swarm
                </mat-option>
                <mat-option value="11">
                  Flora
                </mat-option>
                <mat-option value="12">
                  Aos Sidhe
                </mat-option>
                <mat-option value="13">
                  Spirit
                </mat-option>
                <mat-option value="14">
                  Eldritch
                </mat-option>
                <mat-option value="16">
                  Insectoid
                </mat-option>
                <mat-option value="17">
                  Symbiote
                </mat-option>
                <mat-option value="18">
                  Ooze
                </mat-option>
                <mat-option value="51">
                  Giant
                </mat-option>
                <mat-option value="15">
                  Template
                </mat-option>
              </mat-select>
            </mat-form-field>
            <button mat-raised-button color="accent" (click)="addChip('types')"><i
                class="fa-solid fa-plus icon-medium"></i> Type</button>
          </div>
          <!-- list of types that link to search with that type as a parameter -->

          <h2>Misc Information</h2>
          <div class="divider"></div>
          <div class="box-padding">

            <div>
              <mat-form-field>
                <mat-label>Size</mat-label>
                <mat-select
                  [value]="selectedRoleId ? beast.roleInfo[selectedRoleId].size ? beast.roleInfo[selectedRoleId].size : beast.size : beast.size"
                  (selectionChange)="captureSelectWithRoleConsideration($event, 'size')">
                  <mat-option value="Fine">
                    Fine
                  </mat-option>
                  <mat-option value="Diminutive">
                    Diminutive
                  </mat-option>
                  <mat-option value="Tiny">
                    Tiny
                  </mat-option>
                  <mat-option value="Small">
                    Small
                  </mat-option>
                  <mat-option value="Medium">
                    Medium
                  </mat-option>
                  <mat-option value="Large">
                    Large
                  </mat-option>
                  <mat-option value="Huge">
                    Huge
                  </mat-option>
                  <mat-option value="Giant">
                    Giant
                  </mat-option>
                  <mat-option value="Enormous">
                    Enormous
                  </mat-option>
                  <mat-option value="Colossal">
                    Colossal
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-checkbox *ngIf="selectedRoleId"
                [matTooltipDisabled]="!(selectedRoleId && beast.roleInfo[selectedRoleId].size === beast.size)"
                matTooltip="To set a new default, go to another Role"
                [disabled]="selectedRoleId && beast.roleInfo[selectedRoleId].size === beast.size"
                [checked]="selectedRoleId && beast.roleInfo[selectedRoleId].size === beast.size"
                (change)="updateDefaultSize()">Default Size</mat-checkbox>
            </div>

            <mat-form-field>
              <input placeholder="Senses" matInput [value]="beast.senses" (change)="captureInput($event, 'senses')">
              <mat-hint align="end">{{beast.senses.length}}/500</mat-hint>
            </mat-form-field>

            <h3>Climates</h3>
            <div class="chip-shell">
              <mat-chip-list>
                <div *ngFor="let climate of beast.climates.beast; let i = index">
                  <mat-chip matTooltip="{{climate.examples}}
                  {{climate.code ? 'Kppen Climate Classification: ' + climate.code : ''}}" *ngIf="!climate.deleted"
                    (click)="removeNewSecondaryItem('climates', i, 'beast')" color="warn" selected>
                    {{climate.climate}}
                  </mat-chip>
                </div>
              </mat-chip-list>
              <mat-form-field>
                <mat-label>Select New climate</mat-label>
                <mat-select (selectionChange)="captureChip($event, 'climate')">
                  <mat-option value="all" class="bottom-border">
                    Add All Climates
                  </mat-option>
                  <mat-option value="allClimates">
                    Add All Land Climates
                  </mat-option>
                  <mat-option value="allAquatic">
                    Add All Aquatic Climates
                  </mat-option>
                  <mat-option value="allSpecial" class="bottom-border">
                    Add All Special Climates
                  </mat-option>
                  <mat-option matTooltip="{{climate.examples}}
                  {{climate.code ? 'Kppen Climate Classification: ' + climate.code : ''}}" matTooltipPosition="after"
                    *ngFor="let climate of beast.climates.allclimates" [value]="climate">
                    {{climate.climate}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <br>
              <button mat-raised-button color="accent" (click)="addChip('climate')"><i
                  class="fa-solid fa-plus icon-medium"></i> Climate</button>
            </div>

            <mat-form-field>
              <input matInput placeholder="Diet" [value]="beast.diet" (change)="captureInput($event, 'diet')"
                maxlength="40">
              <mat-hint align="end">{{beast.diet.length}}/500</mat-hint>
            </mat-form-field>

            <mat-form-field>
              <mat-label>Rarity</mat-label>
              <mat-select [(value)]="'' + beast.rarity" (selectionChange)="captureSelect($event, 'rarity')">
                <mat-option value="10">
                  Common
                </mat-option>
                <mat-option value="5">
                  Uncommon
                </mat-option>
                <mat-option value="3">
                  Rare
                </mat-option>
                <mat-option value="1">
                  Legendary
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <h2>Variants</h2>
          <div class="divider"></div>
          <mat-chip-list>
            <div *ngFor="let variant of beast.variants; let i = index">
              <mat-chip *ngIf="!variant.deleted" (click)="removeNewSecondaryItem('variants', i)" color="warn" selected>
                {{variant.name}}</mat-chip>
            </div>
          </mat-chip-list>

          <mat-form-field>
            <input matInput placeholder="Name of Variant Monster" [matAutocomplete]="variantauto"
              [formControl]="variantController">
            <mat-autocomplete #variantauto="matAutocomplete" (optionSelected)="captureVariant($event)"
              [displayWith]="getDisplayVariant">
              <mat-option *ngFor="let variant of variantsFiltered | async" [value]="variant">
                {{variant.name}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>

        <h2>Welgryf Sagas Location(s)</h2>
        <br>
        <div class="chip-shell">
          <mat-chip-list>
            <div *ngFor="let location of beast.locations; let i = index">
              <mat-chip *ngIf="!location.deleted" (click)="removeNewSecondaryItem('locations', i)" color="warn"
                selected>
                {{location.location}}
              </mat-chip>
            </div>
          </mat-chip-list>
        </div>

        <div>
          <br>
          <mat-form-field>
            <input placeholder="Location" matInput [matAutocomplete]="locationauto" [formControl]="locationController">
            <mat-autocomplete #locationauto="matAutocomplete" [displayWith]="getDisplayTextLocation"
              (optionSelected)="setLocation($event)">
              <mat-option *ngFor="let location of locationFiltered | async" [value]="location">
                {{location.location}}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <br>

          <div class="new-location-accordion-shell">
            <mat-accordion>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    <h3><i class="fa-solid fa-plus icon-medium"></i> New Location</h3>
                  </mat-panel-title>
                </mat-expansion-panel-header>

                <div class="new-roll-shell">
                  <mat-form-field>
                    <input #locationLocation placeholder="Location" matInput
                      (change)="captureNewLocation('location', $event)">
                  </mat-form-field>

                  <mat-form-field>
                    <input #locationLink placeholder="Link" matInput (change)="captureNewLocation('link', $event)">
                  </mat-form-field>

                  <button mat-raised-button (click)="addNewLocation()" color="accent"><i
                      class="fa-solid fa-plus icon-medium"></i> Location</button>
                </div>

              </mat-expansion-panel>
            </mat-accordion>
          </div>
        </div>

        <h2>Meta Notes</h2>
        <div class="divider"></div>
        <div>
          <quill-editor [(ngModel)]="beast.meta" (onContentChanged)="captureHTML($event, 'meta')"></quill-editor>
          <p class="character-counter">{{beast.meta ? beast.meta.length : 0}} / 5,000 <i
              class="fas fa-info-circle icon-small"
              matTooltip="This also counts the HTML tags which are invisible."></i></p>
        </div>
      </ng-template>
    </mat-tab>
  </mat-tab-group>

  <br>
  <div class="divider"></div>
  <br>

  <button (click)="saveChanges()" mat-raised-button color="primary" [disabled]="!beast.name || !checkIfValidTemplate()">
    {{!beast.name ? 'Your beast needs a name to save it' : !checkIfValidTemplate() ? "You cannot have Template at the
    start of your monster's name" : beast.name ? 'Save Monster' : 'Unknown Naming Error'}}</button>
  <div *ngIf="beast.id">
    <div *ngIf="checkForDelete" class="deleteButton">
      <button mat-raised-button (click)="deleteThisBeast()" color="warn" matTooltip="Yes, Delete this Monster"><i
          class="fa-solid fa-check"></i></button>
      <button mat-raised-button (click)="toggleCheckDelete()" color="primary" matTooltip="Nevermind"><i
          class="fa-solid fa-x"></i></button>
    </div>
    <div *ngIf="!checkForDelete" class="deleteButton">
      <button (click)="toggleCheckDelete()" mat-raised-button color="warn">Delete Monster</button>
    </div>
  </div>
</mat-card>